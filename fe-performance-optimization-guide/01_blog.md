# Blog service optimization

> 블로그 서비스를 통한 최적화 이론과 기법 배우기  
> - 로딩 성능 최적화
>   - 이미지 사이즈 최적화, 코드 분할, 텍스트 압축
> - 렌더링 성능 최적화
>   - 병목 코드 최적화

## 🔹 이미지 사이즈 최적화

### 💡 **Properly size images: 적절한 사이즈의 이미지 제안**  
화면에 표시되는 이미지 사이즈보다 더 큰 사이즈로 다운되는 상태  
-> 이미지는 화면 사이즈보다 2배 큰 사이즈가 적절  (요즘의 디스플레이는 같은 공간(픽셀)에 더 많은 픽셀 그릴 수 있기에)  
ex. `120 * 120` -> `240 * 240` 다운

### cf. 이미지 CDN

Content Delivery Network  
물리적 거리의 한계 극복위해 소비자(사용자)와 가까운 곳에 콘텐츠 서버 두는 기술  
ex. 한국의 사용자가 미국 서버에서 이미지 다운로드시, 물리적 거리로 인해 다운로드 시간이 걸릴 것  
-> 미국 서버를 미리 한국에 복사하고 -> 사용자가 한국 서버에서 다운로드 하도록 하는 것

## 🔹 코드 분할


## 🔹 텍스트 압축

- 다운로드 필요한 리소스를 서버에서 미리 압축 -> 더 작은 사이즈로 다운로드 가능


## 🔹 병목 코드 최적화

병목 코드 = 서비스 느리게 다운로드/실행되게 하는 특정 자바스크립트 코드

---

## 🔎 performance pannel

### CPU / Network / Screenshot chart

- CPU (CPU가 어떤 작업에 리소스 사용하는지 비율)
  - 노란색: 자바스크립트 실행
  - 보라색: 렌더링/레이아웃 작업
  - 초록색: 페인팅 작업
  - 회색: 기타 시스템 작업
  - 빨간색: 병목 발생 (= 메인 스레드 오래 잡아두고 있는 것)
- Network
  - 진한 막대: 우선순위가 높은 네트워크 리소스
  - 연한 막대: 우선순위가 낮은 네트워크 리소스
- Screenshot
  - 서비스가 로드되는 과정 (스크린샷)

### Network (시간 순서에 따른 네트워크 요청)

- 왼쪽 회색 선: 초기 연결 시간
- 막대의 옅은 색 영역: 요청시점부터 응답 기다리는 시점까지 (TTFB: Time to First Byte)
- 막대의 짙은 색 영역: 콘텐츠 다운로드 시간
- 오른쪽 회색 선: 해당 요청에 대한 메인 스레드 작업 시간

### Frames, Timings, Main

- Frames
  - 화면의 변화가 있을 때마다 스크린샷 찍어 보여줌
- Timings
  - 리액트에서 각 컴포넌트의 렌더링 시간 측정 (User Timing API 통해 기록된 정보 기록)
  - 리액트 17버전 이후로는 지원 종료
- Main
  - 브라우저의 메인 스레드에서 실행하는 작업을 플레임 차트(Flame Chart)로 보여줌
  - 어떤 작업이 오래 걸리는지 파악 가능

### 하단 탭

- Summary
  - 선택 영역에서 발생한 작업 시간의 총합과 각 작업의 차지 비중
- Bottom-Up
  - 가장 최하위의 작업부터 상위 작업까지 역순
- Call Tree
  - 가장 상위 작업부터 하위 작업순으로 작업 내용 보여줌
- Event Log
  - 발생한 이벤트 (Loading, Experience, Scripting, Rendering, Painting) 

---

# Tool: Chrome browser pannel

## Web Vitals (웹 바이탈)

### 📍 FCP (First Contentful Paint)

브라우저가 DOM 콘텐츠의 첫번째 부분을 렌더링하는데 걸리는 시간  
총점 계산 내 10% 가중치

### 📍 SI (Speed Index)

페이지 로드 중에, 콘텐츠가 시각적으로 표시되는 속도 나타내는 지표  
10% 가중치

### 📍 LCP (Largest Contentful Paint)

화면 내 가장 큰 이미지 or 텍스트 요소가 렌더링되기까지의 걸리는 시간  
25% 가중치

### 📍 TTI (Time to Interactive)

사용자가 페이지와 상호작용이 가능한 시점까지 걸리는 시간  
상호작용 = 클릭/키보드 누름 동작  
해당 시점 전까지는 클릭같은 동작이 되지 않음  
10% 가중치

### 📍 TBT (Total Blocking Time)

사용자 입력에 응답하지 않도록 차단된 시간의 총합  
FCP와 TTI 사이의 시간  
메인스레드를 독점해 다른 동작 방해하는 작업에 걸린 시간 총합  
30% 가중치

### 📍 CLS (Cumulative Layout Shift)

페이지 로드 중, 예기치 못한 레이아웃 이동을 측정  
레이아웃 이동 = 화면상 요소의 위치/크기가 순간적으로 변하는 것  
15% 가중치

## Opportunities / Diagnostics

웹 페이지의 문제점, 해결 방안, 해결이점을 보여줌 => 성능 향상 개선 포인트 파악 가능

### Opportunities

빨리 로드하는 데에 잠재적인 도움 제안

### Diagnostics

로드 속도와 직접적인 관계는 없지만, 성능과 관련된 기타 정보

---

### 페이지 로드 과정

- parseHTML
- 자바스크립트 실행


> 40p까지 읽음
